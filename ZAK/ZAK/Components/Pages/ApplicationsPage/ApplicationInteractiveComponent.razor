@using BlazorApp.Enums;
@using System.ComponentModel.DataAnnotations;
@using BlazorApp.DA;
@using BlazorBootstrap;


@inject IDaoBase<Application, ApplicationModel> applicationsDataAccess;

<Switch Label="Ignored"      ValueChanged="PressIgnored" />
<Switch Label="Hot"          ValueChanged="PressHot"/>
<Switch Label="In schedule"  ValueChanged="PressAddToSchedule"/>
<NumberInput TValue="int" @bind-Value="@maxDays"  @bind-Value:after="UpdateMaxDays" />

@code {
    [Parameter] public int applicationId { get; set; }
    [Parameter] public bool ignored { get; set; }
    [Parameter] public bool hot { get; set; }
    [Parameter] public bool inSchedule { get; set; }
    [Parameter] public int maxDays {get;set;}

    private async void PressIgnored()
    {
        ignored = !ignored;

        Application application = await applicationsDataAccess.GetById(applicationId);
        application.ignored = ignored;
        await applicationsDataAccess.Update(application, application.id);
    }
    
    private async void PressHot()
    {
        hot = !hot;

        Application application = await applicationsDataAccess.GetById(applicationId);
        application.hot = hot;
        await applicationsDataAccess.Update(application, application.id);

    }

    private async void PressAddToSchedule()
    {
        inSchedule = !inSchedule;

        Application application = await applicationsDataAccess.GetById(applicationId);
        application.inSchedule = hot;
        await applicationsDataAccess.Update(application, application.id);
    }

    private async void UpdateMaxDays()
    {
        Application application = await applicationsDataAccess.GetById(applicationId);
        application.maxDaysForConnection = maxDays;
        await applicationsDataAccess.Update(application, application.id);
    }

}
